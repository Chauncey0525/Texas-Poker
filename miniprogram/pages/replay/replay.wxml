<!--pages/replay/replay.wxml-->
<view class="container">
  <view class="header card">
    <view class="title">复盘记录</view>
    <text class="subtitle">共 {{gameHistory.length}} 条记录</text>
  </view>

  <view wx:if="{{gameHistory.length === 0}}" class="empty-state">
    <text>暂无复盘记录</text>
    <text>开始模拟练习后，记录会自动保存</text>
  </view>

  <view wx:else class="history-list">
    <view 
      class="history-item card" 
      wx:for="{{gameHistory}}" 
      wx:key="id"
      data-index="{{index}}"
      bindtap="viewReplay"
    >
      <view class="item-header">
        <text class="item-time">{{item.timestamp}}</text>
        <text class="item-id">#{{item.id.slice(-6)}}</text>
      </view>
      <view class="item-content">
        <text>玩家数: {{item.gameState.players.length}}</text>
        <text>底池: {{item.gameState.pot}}</text>
        <text>阶段: {{item.gameState.gamePhase || 'preflop'}}</text>
        <text>结果: {{item.finalResult ? item.finalResult.message : '未完成'}}</text>
      </view>
      <view class="item-actions">
        <button class="btn btn-primary" size="mini" data-index="{{index}}" bindtap="viewReplay" catchtap="stopPropagation">查看</button>
        <button class="btn btn-danger" size="mini" data-id="{{item.id}}" bindtap="deleteRecord" catchtap="stopPropagation">删除</button>
      </view>
    </view>
  </view>

  <view wx:if="{{gameHistory.length > 0}}" class="footer">
    <button class="btn btn-danger" bindtap="clearAll">清空所有记录</button>
  </view>
</view>
